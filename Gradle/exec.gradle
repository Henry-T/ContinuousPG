

task execTask(type:Exec) {
    environment System.getProperties()
    commandLine 'cmd', '/c', 'tree'
    workingDir 'build'
}

task execDSL {
  doLast {
    def result = exec {
        environment = System.getProperties()
        executable = 'cmd'
        args = ['/c', 'tree']
    }
    println "exit value: "+result.getExitValue()
    if (result.getExitValue() == 0) {
        throw new Exception('I want it to fail!')
    } else {
        println 'this will not execute'
    }    
  }
}

task execJava {
    ProcessPassEnv.startProcess('ruby', 'echoENV.rb', '.')
}